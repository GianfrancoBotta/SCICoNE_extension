Assuming unrestricted shared filesystem usage.
host: eu-g5-040-1
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 10
Rules claiming more threads will be scaled down.
Job stats:
job                            count
---------------------------  -------
all                                1
format_gc_bias_per_cell            6
get_binned_gc_bias_per_cell        6
total                             13

Select jobs to execute...
Failed to solve scheduling problem with ILP solver, falling back to greedy scheduler. You likely have to fix your ILP solver installation. Error message: PULP_CBC_CMD: Not Available (check permissions on cbc)
Execute 6 jobs...

[Fri Oct 24 10:28:03 2025]
localrule get_binned_gc_bias_per_cell:
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc
    log: logs/qc/off_target/gc_bias/QGF-211698_QGF-211701_sc.log
    jobid: 18
    reason: Code has changed since last execution
    wildcards: chr_region=off_target, sample=QGF-211698_QGF-211701
    resources: tmpdir=/scratch/tmp.46740551.gbotta
[Fri Oct 24 10:28:05 2025]
localrule get_binned_gc_bias_per_cell:
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc
    log: logs/qc/on_target/gc_bias/QGF-211699_QGF-211702_sc.log
    jobid: 21
    reason: Forced execution
    wildcards: chr_region=on_target, sample=QGF-211699_QGF-211702
    resources: tmpdir=/scratch/tmp.46740551.gbotta
[Fri Oct 24 10:28:05 2025]
localrule get_binned_gc_bias_per_cell:
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc
    log: logs/qc/on_target/gc_bias/PID2236_sc.log
    jobid: 2
    reason: Forced execution
    wildcards: chr_region=on_target, sample=PID2236
    resources: tmpdir=/scratch/tmp.46740551.gbotta
[Fri Oct 24 10:28:05 2025]
localrule get_binned_gc_bias_per_cell:
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc
    log: logs/qc/off_target/gc_bias/QGF-211699_QGF-211702_sc.log
    jobid: 26
    reason: Forced execution
    wildcards: chr_region=off_target, sample=QGF-211699_QGF-211702
    resources: tmpdir=/scratch/tmp.46740551.gbotta
[Fri Oct 24 10:28:05 2025]
localrule get_binned_gc_bias_per_cell:
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc
    log: logs/qc/off_target/gc_bias/PID2236_sc.log
    jobid: 10
    reason: Forced execution
    wildcards: chr_region=off_target, sample=PID2236
    resources: tmpdir=/scratch/tmp.46740551.gbotta
[Fri Oct 24 10:28:05 2025]
localrule get_binned_gc_bias_per_cell:
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc
    log: logs/qc/on_target/gc_bias/QGF-211698_QGF-211701_sc.log
    jobid: 13
    reason: Code has changed since last execution
    wildcards: chr_region=on_target, sample=QGF-211698_QGF-211701
    resources: tmpdir=/scratch/tmp.46740551.gbotta
Activating singularity image /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg
Activating conda environment: .snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
Activating singularity image /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg
Activating conda environment: .snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
Activating singularity image /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg
Activating conda environment: .snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
Activating singularity image /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg
Activating conda environment: .snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
Activating singularity image /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg
Activating conda environment: .snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
Activating singularity image /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg
Activating conda environment: .snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_/bin/picard: line 5: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8): No such file or directory
INFO	2025-10-24 08:28:24	CollectGcBiasMetrics	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** 
https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    CollectGcBiasMetrics -I /dev/stdin -O /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc/AGACGCTATAAGTTCTCT-1.gc_bias_metrics.txt -S /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc/AGACGCTATAAGTTCTCT-1.summary_metrics.txt -R /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa
**********


ERROR: Option 'CHART_OUTPUT' is required.

USAGE: CollectGcBiasMetrics [options]

Documentation: http://broadinstitute.github.io/picard/command-line-overview.html#CollectGcBiasMetrics

Collect metrics regarding GC bias. This tool collects information about the relative proportions of guanine (G) and
cytosine (C) nucleotides in a sample.  Regions of high and low G + C content have been shown to interfere with
mapping/aligning, ultimately leading to fragmented genome assemblies and poor coverage in a phenomenon known as 'GC
bias'.  Detailed information on the effects of GC bias on the collection and analysis of sequencing data can be found at
DOI: 10.1371/journal.pone.0062856/.


The GC bias statistics are always output in a detailed long-form version, but a summary can also be produced. Both the
detailed metrics and the summary metrics are output as tables '.txt' files) and an accompanying chart that plots the
data ('.pdf' file). 

Detailed metrics
The table of detailed metrics includes GC percentages for each bin (GC), the percentage of WINDOWS corresponding to each
GC bin of the reference sequence, the numbers of reads that start within a particular %GC content bin (READ_STARTS), and
the mean base quality of the reads that correspond to a specific GC content distribution window (MEAN_BASE_QUALITY). 
NORMALIZED_COVERAGE is a relative measure of sequence coverage by the reads at a particular GC content.For each run, the
corresponding reference sequence is divided into bins or windows based on the percentage of G + C content ranging from 0
- 100%.  The percentages of G + C are determined from a defined length of sequence; the default value is set at 100
bases. The mean of the distribution will vary among organisms; human DNA has a mean GC content of 40%, suggesting a
slight preponderance of AT-rich regions.  


Summary metrics
The table of summary metrics captures run-specific bias information including WINDOW_SIZE, ALIGNED_READS,
TOTAL_CLUSTERS, AT_DROPOUT, and GC_DROPOUT.  While WINDOW_SIZE refers to the numbers of bases used for the distribution
(see above), the ALIGNED_READS and TOTAL_CLUSTERS are the total number of aligned reads and the total number of reads
(after filtering) produced in a run. In addition, the tool produces both AT_DROPOUT and GC_DROPOUT metrics, which
indicate the percentage of misaligned reads that correlate with low (%-GC is < 50%) or high (%-GC is > 50%) GC content
respectively.  

The percentage of 'coverage' or depth in a GC bin is calculated by dividing the number of reads of a particular GC
content by the mean number of reads of all GC bins.  A number of 1 represents mean coverage, a number less than 1
represents lower than mean coverage (e.g. 0.5 means half as much coverage as average) while a number greater than 1
represents higher than mean coverage (e.g. 3.1 means this GC bin has 3.1 times more reads per window than average). 
This tool also tracks mean base-quality scores of the reads within each GC content bin, enabling the user to determine
how base quality scores vary with GC content.  

The chart output associated with this data table plots the NORMALIZED_COVERAGE, the distribution of WINDOWs
corresponding to GC percentages, and base qualities corresponding to each %GC bin.
Note: Metrics labeled as percentages are actually expressed as fractions!

Usage Example:

java -jar picard.jar CollectGcBiasMetrics \
I=input.bam \
O=gc_bias_metrics.txt \
CHART=gc_bias_metrics.pdf \
S=summary_metrics.txt \
R=reference_sequence.fasta
Please see the GcBiasMetrics documentation
(https://broadinstitute.github.io/picard/picard-metric-definitions.html#GcBiasMetrics) for further explanations of each
metric.

Version: 3.4.0


Options:

--help
-h                            Displays options specific to this tool.

--stdhelp
-H                            Displays options specific to this tool AND options common to all Picard command line
                              tools.

--version                     Displays program version.

CHART_OUTPUT=File
CHART=File                    The PDF file to render the chart to.  Required. 

SUMMARY_OUTPUT=File
S=File                        The text file to write summary metrics to.  Required. 

SCAN_WINDOW_SIZE=Integer
WINDOW_SIZE=Integer           The size of the scanning windows on the reference genome that are used to bin reads. 
                              Default value: 100. This option can be set to 'null' to clear the default value. 

MINIMUM_GENOME_FRACTION=Double
MGF=Double                    For summary metrics, exclude GC windows that include less than this fraction of the
                              genome.  Default value: 1.0E-5. This option can be set to 'null' to clear the default
                              value. 

IS_BISULFITE_SEQUENCED=Boolean
BS=Boolean                    Whether the SAM or BAM file consists of bisulfite sequenced reads.  Default value: false.
                              This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

METRIC_ACCUMULATION_LEVEL=MetricAccumulationLevel
LEVEL=MetricAccumulationLevel The level(s) at which to accumulate metrics.  Default value: [ALL_READS]. This option can
                              be set to 'null' to clear the default value. Possible values: {ALL_READS, SAMPLE, LIBRARY,
                              READ_GROUP} This option may be specified 0 or more times. This option can be set to 'null'
                              to clear the default list. 

ALSO_IGNORE_DUPLICATES=Boolean
ALSO_IGNORE_DUPLICATES=BooleanUse to get additional results without duplicates. This option allows to gain two plots per
                              level at the same time: one is the usual one and the other excludes duplicates.  Default
                              value: false. This option can be set to 'null' to clear the default value. Possible
                              values: {true, false} 

INPUT=File
I=File                        Input SAM/BAM/CRAM file.  Required. 

OUTPUT=File
O=File                        The file to write the output to.  Required. 

ASSUME_SORTED=Boolean
AS=Boolean                    If true (default), then the sort order in the header file will be ignored.  Default value:
                              true. This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

STOP_AFTER=Long               Stop after processing N reads, mainly for debugging.  Default value: 0. This option can be
                              set to 'null' to clear the default value. 

RuleException:
CalledProcessError in file "/cluster/work/bewi/members/gbotta/exploratory_da/workflow/Snakefile", line 307:
Command ' singularity  exec --home '/cluster/work/bewi/members/gbotta/exploratory_da/workflow' -B /cluster/work/bewi/members/jgawron -B /scratch -B /cluster/work/bewi/members/gbotta:/cluster/work/bewi/members/gbotta:rw --bind '/cluster/home/gbotta/.cache/snakemake/snakemake/source-cache' /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg bash -c 'source /opt/conda/bin/activate '\''/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_'\''; set -euo pipefail;  
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/PID2236_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt'' returned non-zero exit status 1.
[Fri Oct 24 10:28:24 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 10
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc
    log: logs/qc/off_target/gc_bias/PID2236_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/PID2236_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
        
        (command exited with non-zero exit code)
Removing output files of failed job get_binned_gc_bias_per_cell since they might be corrupted:
/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc
/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_/bin/picard: line 5: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8): No such file or directory
/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_/bin/picard: line 5: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8): No such file or directory
/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_/bin/picard: line 5: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8): No such file or directory
/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_/bin/picard: line 5: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8): No such file or directory
/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_/bin/picard: line 5: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8): No such file or directory
INFO	2025-10-24 08:28:32	CollectGcBiasMetrics	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** 
https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    CollectGcBiasMetrics -I /dev/stdin -O /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/TCGTCATTCCCGATGTTC-1.gc_bias_metrics.txt -S /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/TCGTCATTCCCGATGTTC-1.summary_metrics.txt -R /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa
**********


INFO	2025-10-24 08:28:32	CollectGcBiasMetrics	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** 
https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    CollectGcBiasMetrics -I /dev/stdin -O /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/TCGTCATTCCCGATGTTC-1.gc_bias_metrics.txt -S /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/TCGTCATTCCCGATGTTC-1.summary_metrics.txt -R /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa
**********


ERROR: Option 'CHART_OUTPUT' is required.

INFO	2025-10-24 08:28:32	CollectGcBiasMetrics	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** 
https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    CollectGcBiasMetrics -I /dev/stdin -O /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc/AGACGCTATAAGTTCTCT-1.gc_bias_metrics.txt -S /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc/AGACGCTATAAGTTCTCT-1.summary_metrics.txt -R /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa
**********


ERROR: Option 'CHART_OUTPUT' is required.

ERROR: Option 'CHART_OUTPUT' is required.

USAGE: CollectGcBiasMetrics [options]

Documentation: http://broadinstitute.github.io/picard/command-line-overview.html#CollectGcBiasMetrics

Collect metrics regarding GC bias. This tool collects information about the relative proportions of guanine (G) and
cytosine (C) nucleotides in a sample.  Regions of high and low G + C content have been shown to interfere with
mapping/aligning, ultimately leading to fragmented genome assemblies and poor coverage in a phenomenon known as 'GC
bias'.  Detailed information on the effects of GC bias on the collection and analysis of sequencing data can be found at
DOI: 10.1371/journal.pone.0062856/.


The GC bias statistics are always output in a detailed long-form version, but a summary can also be produced. Both the
detailed metrics and the summary metrics are output as tables '.txt' files) and an accompanying chart that plots the
data ('.pdf' file). 

Detailed metrics
The table of detailed metrics includes GC percentages for each bin (GC), the percentage of WINDOWS corresponding to each
GC bin of the reference sequence, the numbers of reads that start within a particular %GC content bin (READ_STARTS), and
the mean base quality of the reads that correspond to a specific GC content distribution window (MEAN_BASE_QUALITY). 
NORMALIZED_COVERAGE is a relative measure of sequence coverage by the reads at a particular GC content.For each run, the
corresponding reference sequence is divided into bins or windows based on the percentage of G + C content ranging from 0
- 100%.  The percentages of G + C are determined from a defined length of sequence; the default value is set at 100
bases. The mean of the distribution will vary among organisms; human DNA has a mean GC content of 40%, suggesting a
slight preponderance of AT-rich regions.  


Summary metrics
The table of summary metrics captures run-specific bias information including WINDOW_SIZE, ALIGNED_READS,
TOTAL_CLUSTERS, AT_DROPOUT, and GC_DROPOUT.  While WINDOW_SIZE refers to the numbers of bases used for the distribution
(see above), the ALIGNED_READS and TOTAL_CLUSTERS are the total number of aligned reads and the total number of reads
(after filtering) produced in a run. In addition, the tool produces both AT_DROPOUT and GC_DROPOUT metrics, which
indicate the percentage of misaligned reads that correlate with low (%-GC is < 50%) or high (%-GC is > 50%) GC content
respectively.  

The percentage of 'coverage' or depth in a GC bin is calculated by dividing the number of reads of a particular GC
content by the mean number of reads of all GC bins.  A number of 1 represents mean coverage, a number less than 1
represents lower than mean coverage (e.g. 0.5 means half as much coverage as average) while a number greater than 1
represents higher than mean coverage (e.g. 3.1 means this GC bin has 3.1 times more reads per window than average). 
This tool also tracks mean base-quality scores of the reads within each GC content bin, enabling the user to determine
how base quality scores vary with GC content.  

The chart output associated with this data table plots the NORMALIZED_COVERAGE, the distribution of WINDOWs
corresponding to GC percentages, and base qualities corresponding to each %GC bin.
Note: Metrics labeled as percentages are actually expressed as fractions!

Usage Example:

java -jar picard.jar CollectGcBiasMetrics \
I=input.bam \
O=gc_bias_metrics.txt \
CHART=gc_bias_metrics.pdf \
S=summary_metrics.txt \
R=reference_sequence.fasta
Please see the GcBiasMetrics documentation
(https://broadinstitute.github.io/picard/picard-metric-definitions.html#GcBiasMetrics) for further explanations of each
metric.

Version: 3.4.0


Options:

--help
-h                            Displays options specific to this tool.

--stdhelp
-H                            Displays options specific to this tool AND options common to all Picard command line
                              tools.

--version                     Displays program version.

CHART_OUTPUT=File
CHART=File                    The PDF file to render the chart to.  Required. 

SUMMARY_OUTPUT=File
S=File                        The text file to write summary metrics to.  Required. 

SCAN_WINDOW_SIZE=Integer
WINDOW_SIZE=Integer           The size of the scanning windows on the reference genome that are used to bin reads. 
                              Default value: 100. This option can be set to 'null' to clear the default value. 

MINIMUM_GENOME_FRACTION=Double
MGF=Double                    For summary metrics, exclude GC windows that include less than this fraction of the
                              genome.  Default value: 1.0E-5. This option can be set to 'null' to clear the default
                              value. 

IS_BISULFITE_SEQUENCED=Boolean
BS=Boolean                    Whether the SAM or BAM file consists of bisulfite sequenced reads.  Default value: false.
                              This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

METRIC_ACCUMULATION_LEVEL=MetricAccumulationLevel
LEVEL=MetricAccumulationLevel The level(s) at which to accumulate metrics.  Default value: [ALL_READS]. This option can
                              be set to 'null' to clear the default value. Possible values: {ALL_READS, SAMPLE, LIBRARY,
                              READ_GROUP} This option may be specified 0 or more times. This option can be set to 'null'
                              to clear the default list. 

ALSO_IGNORE_DUPLICATES=Boolean
ALSO_IGNORE_DUPLICATES=BooleanUse to get additional results without duplicates. This option allows to gain two plots per
                              level at the same time: one is the usual one and the other excludes duplicates.  Default
                              value: false. This option can be set to 'null' to clear the default value. Possible
                              values: {true, false} 

INPUT=File
I=File                        Input SAM/BAM/CRAM file.  Required. 

OUTPUT=File
O=File                        The file to write the output to.  Required. 

ASSUME_SORTED=Boolean
AS=Boolean                    If true (default), then the sort order in the header file will be ignored.  Default value:
                              true. This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

STOP_AFTER=Long               Stop after processing N reads, mainly for debugging.  Default value: 0. This option can be
                              set to 'null' to clear the default value. 

INFO	2025-10-24 08:28:32	CollectGcBiasMetrics	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** 
https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    CollectGcBiasMetrics -I /dev/stdin -O /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/CACCTCGGATCGTCATTC-1.gc_bias_metrics.txt -S /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/CACCTCGGATCGTCATTC-1.summary_metrics.txt -R /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa
**********


USAGE: CollectGcBiasMetrics [options]

Documentation: http://broadinstitute.github.io/picard/command-line-overview.html#CollectGcBiasMetrics

Collect metrics regarding GC bias. This tool collects information about the relative proportions of guanine (G) and
cytosine (C) nucleotides in a sample.  Regions of high and low G + C content have been shown to interfere with
mapping/aligning, ultimately leading to fragmented genome assemblies and poor coverage in a phenomenon known as 'GC
bias'.  Detailed information on the effects of GC bias on the collection and analysis of sequencing data can be found at
DOI: 10.1371/journal.pone.0062856/.


The GC bias statistics are always output in a detailed long-form version, but a summary can also be produced. Both the
detailed metrics and the summary metrics are output as tables '.txt' files) and an accompanying chart that plots the
data ('.pdf' file). 

Detailed metrics
The table of detailed metrics includes GC percentages for each bin (GC), the percentage of WINDOWS corresponding to each
GC bin of the reference sequence, the numbers of reads that start within a particular %GC content bin (READ_STARTS), and
the mean base quality of the reads that correspond to a specific GC content distribution window (MEAN_BASE_QUALITY). 
NORMALIZED_COVERAGE is a relative measure of sequence coverage by the reads at a particular GC content.For each run, the
corresponding reference sequence is divided into bins or windows based on the percentage of G + C content ranging from 0
- 100%.  The percentages of G + C are determined from a defined length of sequence; the default value is set at 100
bases. The mean of the distribution will vary among organisms; human DNA has a mean GC content of 40%, suggesting a
slight preponderance of AT-rich regions.  


Summary metrics
The table of summary metrics captures run-specific bias information including WINDOW_SIZE, ALIGNED_READS,
TOTAL_CLUSTERS, AT_DROPOUT, and GC_DROPOUT.  While WINDOW_SIZE refers to the numbers of bases used for the distribution
(see above), the ALIGNED_READS and TOTAL_CLUSTERS are the total number of aligned reads and the total number of reads
(after filtering) produced in a run. In addition, the tool produces both AT_DROPOUT and GC_DROPOUT metrics, which
indicate the percentage of misaligned reads that correlate with low (%-GC is < 50%) or high (%-GC is > 50%) GC content
respectively.  

The percentage of 'coverage' or depth in a GC bin is calculated by dividing the number of reads of a particular GC
content by the mean number of reads of all GC bins.  A number of 1 represents mean coverage, a number less than 1
represents lower than mean coverage (e.g. 0.5 means half as much coverage as average) while a number greater than 1
represents higher than mean coverage (e.g. 3.1 means this GC bin has 3.1 times more reads per window than average). 
This tool also tracks mean base-quality scores of the reads within each GC content bin, enabling the user to determine
how base quality scores vary with GC content.  

The chart output associated with this data table plots the NORMALIZED_COVERAGE, the distribution of WINDOWs
corresponding to GC percentages, and base qualities corresponding to each %GC bin.
Note: Metrics labeled as percentages are actually expressed as fractions!

Usage Example:

java -jar picard.jar CollectGcBiasMetrics \
I=input.bam \
O=gc_bias_metrics.txt \
CHART=gc_bias_metrics.pdf \
S=summary_metrics.txt \
R=reference_sequence.fasta
Please see the GcBiasMetrics documentation
(https://broadinstitute.github.io/picard/picard-metric-definitions.html#GcBiasMetrics) for further explanations of each
metric.

Version: 3.4.0


Options:

--help
-h                            Displays options specific to this tool.

--stdhelp
-H                            Displays options specific to this tool AND options common to all Picard command line
                              tools.

--version                     Displays program version.

CHART_OUTPUT=File
CHART=File                    The PDF file to render the chart to.  Required. 

SUMMARY_OUTPUT=File
S=File                        The text file to write summary metrics to.  Required. 

SCAN_WINDOW_SIZE=Integer
WINDOW_SIZE=Integer           The size of the scanning windows on the reference genome that are used to bin reads. 
                              Default value: 100. This option can be set to 'null' to clear the default value. 

MINIMUM_GENOME_FRACTION=Double
MGF=Double                    For summary metrics, exclude GC windows that include less than this fraction of the
                              genome.  Default value: 1.0E-5. This option can be set to 'null' to clear the default
                              value. 

IS_BISULFITE_SEQUENCED=Boolean
BS=Boolean                    Whether the SAM or BAM file consists of bisulfite sequenced reads.  Default value: false.
                              This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

METRIC_ACCUMULATION_LEVEL=MetricAccumulationLevel
LEVEL=MetricAccumulationLevel The level(s) at which to accumulate metrics.  Default value: [ALL_READS]. This option can
                              be set to 'null' to clear the default value. Possible values: {ALL_READS, SAMPLE, LIBRARY,
                              READ_GROUP} This option may be specified 0 or more times. This option can be set to 'null'
                              to clear the default list. 

ALSO_IGNORE_DUPLICATES=Boolean
ALSO_IGNORE_DUPLICATES=BooleanUse to get additional results without duplicates. This option allows to gain two plots per
                              level at the same time: one is the usual one and the other excludes duplicates.  Default
                              value: false. This option can be set to 'null' to clear the default value. Possible
                              values: {true, false} 

INPUT=File
I=File                        Input SAM/BAM/CRAM file.  Required. 

OUTPUT=File
O=File                        The file to write the output to.  Required. 

ASSUME_SORTED=Boolean
AS=Boolean                    If true (default), then the sort order in the header file will be ignored.  Default value:
                              true. This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

STOP_AFTER=Long               Stop after processing N reads, mainly for debugging.  Default value: 0. This option can be
                              set to 'null' to clear the default value. 

ERROR: Option 'CHART_OUTPUT' is required.

RuleException:
CalledProcessError in file "/cluster/work/bewi/members/gbotta/exploratory_da/workflow/Snakefile", line 307:
Command ' singularity  exec --home '/cluster/work/bewi/members/gbotta/exploratory_da/workflow' -B /cluster/work/bewi/members/jgawron -B /scratch -B /cluster/work/bewi/members/gbotta:/cluster/work/bewi/members/gbotta:rw --bind '/cluster/home/gbotta/.cache/snakemake/snakemake/source-cache' /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg bash -c 'source /opt/conda/bin/activate '\''/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_'\''; set -euo pipefail;  
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/QGF-211699_QGF-211702_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt'' returned non-zero exit status 1.
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 26
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc
    log: logs/qc/off_target/gc_bias/QGF-211699_QGF-211702_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/QGF-211699_QGF-211702_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
        
        (command exited with non-zero exit code)
USAGE: CollectGcBiasMetrics [options]

Documentation: http://broadinstitute.github.io/picard/command-line-overview.html#CollectGcBiasMetrics

Collect metrics regarding GC bias. This tool collects information about the relative proportions of guanine (G) and
cytosine (C) nucleotides in a sample.  Regions of high and low G + C content have been shown to interfere with
mapping/aligning, ultimately leading to fragmented genome assemblies and poor coverage in a phenomenon known as 'GC
bias'.  Detailed information on the effects of GC bias on the collection and analysis of sequencing data can be found at
DOI: 10.1371/journal.pone.0062856/.


The GC bias statistics are always output in a detailed long-form version, but a summary can also be produced. Both the
detailed metrics and the summary metrics are output as tables '.txt' files) and an accompanying chart that plots the
data ('.pdf' file). 

Detailed metrics
The table of detailed metrics includes GC percentages for each bin (GC), the percentage of WINDOWS corresponding to each
GC bin of the reference sequence, the numbers of reads that start within a particular %GC content bin (READ_STARTS), and
the mean base quality of the reads that correspond to a specific GC content distribution window (MEAN_BASE_QUALITY). 
NORMALIZED_COVERAGE is a relative measure of sequence coverage by the reads at a particular GC content.For each run, the
corresponding reference sequence is divided into bins or windows based on the percentage of G + C content ranging from 0
- 100%.  The percentages of G + C are determined from a defined length of sequence; the default value is set at 100
bases. The mean of the distribution will vary among organisms; human DNA has a mean GC content of 40%, suggesting a
slight preponderance of AT-rich regions.  


Summary metrics
The table of summary metrics captures run-specific bias information including WINDOW_SIZE, ALIGNED_READS,
TOTAL_CLUSTERS, AT_DROPOUT, and GC_DROPOUT.  While WINDOW_SIZE refers to the numbers of bases used for the distribution
(see above), the ALIGNED_READS and TOTAL_CLUSTERS are the total number of aligned reads and the total number of reads
(after filtering) produced in a run. In addition, the tool produces both AT_DROPOUT and GC_DROPOUT metrics, which
indicate the percentage of misaligned reads that correlate with low (%-GC is < 50%) or high (%-GC is > 50%) GC content
respectively.  

The percentage of 'coverage' or depth in a GC bin is calculated by dividing the number of reads of a particular GC
content by the mean number of reads of all GC bins.  A number of 1 represents mean coverage, a number less than 1
represents lower than mean coverage (e.g. 0.5 means half as much coverage as average) while a number greater than 1
represents higher than mean coverage (e.g. 3.1 means this GC bin has 3.1 times more reads per window than average). 
This tool also tracks mean base-quality scores of the reads within each GC content bin, enabling the user to determine
how base quality scores vary with GC content.  

The chart output associated with this data table plots the NORMALIZED_COVERAGE, the distribution of WINDOWs
corresponding to GC percentages, and base qualities corresponding to each %GC bin.
Note: Metrics labeled as percentages are actually expressed as fractions!

Usage Example:

java -jar picard.jar CollectGcBiasMetrics \
I=input.bam \
O=gc_bias_metrics.txt \
CHART=gc_bias_metrics.pdf \
S=summary_metrics.txt \
R=reference_sequence.fasta
Please see the GcBiasMetrics documentation
(https://broadinstitute.github.io/picard/picard-metric-definitions.html#GcBiasMetrics) for further explanations of each
metric.

Version: 3.4.0


Options:

--help
-h                            Displays options specific to this tool.

--stdhelp
-H                            Displays options specific to this tool AND options common to all Picard command line
                              tools.

--version                     Displays program version.

CHART_OUTPUT=File
CHART=File                    The PDF file to render the chart to.  Required. 

SUMMARY_OUTPUT=File
S=File                        The text file to write summary metrics to.  Required. 

SCAN_WINDOW_SIZE=Integer
WINDOW_SIZE=Integer           The size of the scanning windows on the reference genome that are used to bin reads. 
                              Default value: 100. This option can be set to 'null' to clear the default value. 

MINIMUM_GENOME_FRACTION=Double
MGF=Double                    For summary metrics, exclude GC windows that include less than this fraction of the
                              genome.  Default value: 1.0E-5. This option can be set to 'null' to clear the default
                              value. 

IS_BISULFITE_SEQUENCED=Boolean
BS=Boolean                    Whether the SAM or BAM file consists of bisulfite sequenced reads.  Default value: false.
                              This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

METRIC_ACCUMULATION_LEVEL=MetricAccumulationLevel
LEVEL=MetricAccumulationLevel The level(s) at which to accumulate metrics.  Default value: [ALL_READS]. This option can
                              be set to 'null' to clear the default value. Possible values: {ALL_READS, SAMPLE, LIBRARY,
                              READ_GROUP} This option may be specified 0 or more times. This option can be set to 'null'
                              to clear the default list. 

ALSO_IGNORE_DUPLICATES=Boolean
ALSO_IGNORE_DUPLICATES=BooleanUse to get additional results without duplicates. This option allows to gain two plots per
                              level at the same time: one is the usual one and the other excludes duplicates.  Default
                              value: false. This option can be set to 'null' to clear the default value. Possible
                              values: {true, false} 

INPUT=File
I=File                        Input SAM/BAM/CRAM file.  Required. 

OUTPUT=File
O=File                        The file to write the output to.  Required. 

ASSUME_SORTED=Boolean
AS=Boolean                    If true (default), then the sort order in the header file will be ignored.  Default value:
                              true. This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

STOP_AFTER=Long               Stop after processing N reads, mainly for debugging.  Default value: 0. This option can be
                              set to 'null' to clear the default value. 

INFO	2025-10-24 08:28:32	CollectGcBiasMetrics	

********** NOTE: Picard's command line syntax is changing.
**********
********** For more information, please see:
********** 
https://github.com/broadinstitute/picard/wiki/Command-Line-Syntax-Transition-For-Users-(Pre-Transition)
**********
********** The command line looks like this in the new syntax:
**********
**********    CollectGcBiasMetrics -I /dev/stdin -O /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/CACCTCGGATCGTCATTC-1.gc_bias_metrics.txt -S /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/CACCTCGGATCGTCATTC-1.summary_metrics.txt -R /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa
**********


ERROR: Option 'CHART_OUTPUT' is required.

Removing output files of failed job get_binned_gc_bias_per_cell since they might be corrupted:
/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc
USAGE: CollectGcBiasMetrics [options]

Documentation: http://broadinstitute.github.io/picard/command-line-overview.html#CollectGcBiasMetrics

Collect metrics regarding GC bias. This tool collects information about the relative proportions of guanine (G) and
cytosine (C) nucleotides in a sample.  Regions of high and low G + C content have been shown to interfere with
mapping/aligning, ultimately leading to fragmented genome assemblies and poor coverage in a phenomenon known as 'GC
bias'.  Detailed information on the effects of GC bias on the collection and analysis of sequencing data can be found at
DOI: 10.1371/journal.pone.0062856/.


The GC bias statistics are always output in a detailed long-form version, but a summary can also be produced. Both the
detailed metrics and the summary metrics are output as tables '.txt' files) and an accompanying chart that plots the
data ('.pdf' file). 

Detailed metrics
The table of detailed metrics includes GC percentages for each bin (GC), the percentage of WINDOWS corresponding to each
GC bin of the reference sequence, the numbers of reads that start within a particular %GC content bin (READ_STARTS), and
the mean base quality of the reads that correspond to a specific GC content distribution window (MEAN_BASE_QUALITY). 
NORMALIZED_COVERAGE is a relative measure of sequence coverage by the reads at a particular GC content.For each run, the
corresponding reference sequence is divided into bins or windows based on the percentage of G + C content ranging from 0
- 100%.  The percentages of G + C are determined from a defined length of sequence; the default value is set at 100
bases. The mean of the distribution will vary among organisms; human DNA has a mean GC content of 40%, suggesting a
slight preponderance of AT-rich regions.  


Summary metrics
The table of summary metrics captures run-specific bias information including WINDOW_SIZE, ALIGNED_READS,
TOTAL_CLUSTERS, AT_DROPOUT, and GC_DROPOUT.  While WINDOW_SIZE refers to the numbers of bases used for the distribution
(see above), the ALIGNED_READS and TOTAL_CLUSTERS are the total number of aligned reads and the total number of reads
(after filtering) produced in a run. In addition, the tool produces both AT_DROPOUT and GC_DROPOUT metrics, which
indicate the percentage of misaligned reads that correlate with low (%-GC is < 50%) or high (%-GC is > 50%) GC content
respectively.  

The percentage of 'coverage' or depth in a GC bin is calculated by dividing the number of reads of a particular GC
content by the mean number of reads of all GC bins.  A number of 1 represents mean coverage, a number less than 1
represents lower than mean coverage (e.g. 0.5 means half as much coverage as average) while a number greater than 1
represents higher than mean coverage (e.g. 3.1 means this GC bin has 3.1 times more reads per window than average). 
This tool also tracks mean base-quality scores of the reads within each GC content bin, enabling the user to determine
how base quality scores vary with GC content.  

The chart output associated with this data table plots the NORMALIZED_COVERAGE, the distribution of WINDOWs
corresponding to GC percentages, and base qualities corresponding to each %GC bin.
Note: Metrics labeled as percentages are actually expressed as fractions!

Usage Example:

java -jar picard.jar CollectGcBiasMetrics \
I=input.bam \
O=gc_bias_metrics.txt \
CHART=gc_bias_metrics.pdf \
S=summary_metrics.txt \
R=reference_sequence.fasta
Please see the GcBiasMetrics documentation
(https://broadinstitute.github.io/picard/picard-metric-definitions.html#GcBiasMetrics) for further explanations of each
metric.

Version: 3.4.0


Options:

--help
-h                            Displays options specific to this tool.

--stdhelp
-H                            Displays options specific to this tool AND options common to all Picard command line
                              tools.

--version                     Displays program version.

CHART_OUTPUT=File
CHART=File                    The PDF file to render the chart to.  Required. 

SUMMARY_OUTPUT=File
S=File                        The text file to write summary metrics to.  Required. 

SCAN_WINDOW_SIZE=Integer
WINDOW_SIZE=Integer           The size of the scanning windows on the reference genome that are used to bin reads. 
                              Default value: 100. This option can be set to 'null' to clear the default value. 

MINIMUM_GENOME_FRACTION=Double
MGF=Double                    For summary metrics, exclude GC windows that include less than this fraction of the
                              genome.  Default value: 1.0E-5. This option can be set to 'null' to clear the default
                              value. 

IS_BISULFITE_SEQUENCED=Boolean
BS=Boolean                    Whether the SAM or BAM file consists of bisulfite sequenced reads.  Default value: false.
                              This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

METRIC_ACCUMULATION_LEVEL=MetricAccumulationLevel
LEVEL=MetricAccumulationLevel The level(s) at which to accumulate metrics.  Default value: [ALL_READS]. This option can
                              be set to 'null' to clear the default value. Possible values: {ALL_READS, SAMPLE, LIBRARY,
                              READ_GROUP} This option may be specified 0 or more times. This option can be set to 'null'
                              to clear the default list. 

ALSO_IGNORE_DUPLICATES=Boolean
ALSO_IGNORE_DUPLICATES=BooleanUse to get additional results without duplicates. This option allows to gain two plots per
                              level at the same time: one is the usual one and the other excludes duplicates.  Default
                              value: false. This option can be set to 'null' to clear the default value. Possible
                              values: {true, false} 

INPUT=File
I=File                        Input SAM/BAM/CRAM file.  Required. 

OUTPUT=File
O=File                        The file to write the output to.  Required. 

ASSUME_SORTED=Boolean
AS=Boolean                    If true (default), then the sort order in the header file will be ignored.  Default value:
                              true. This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

STOP_AFTER=Long               Stop after processing N reads, mainly for debugging.  Default value: 0. This option can be
                              set to 'null' to clear the default value. 

RuleException:
CalledProcessError in file "/cluster/work/bewi/members/gbotta/exploratory_da/workflow/Snakefile", line 307:
Command ' singularity  exec --home '/cluster/work/bewi/members/gbotta/exploratory_da/workflow' -B /cluster/work/bewi/members/jgawron -B /scratch -B /cluster/work/bewi/members/gbotta:/cluster/work/bewi/members/gbotta:rw --bind '/cluster/home/gbotta/.cache/snakemake/snakemake/source-cache' /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg bash -c 'source /opt/conda/bin/activate '\''/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_'\''; set -euo pipefail;  
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/PID2236_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt'' returned non-zero exit status 1.
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 2
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc
    log: logs/qc/on_target/gc_bias/PID2236_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/PID2236_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
        
        (command exited with non-zero exit code)
Removing output files of failed job get_binned_gc_bias_per_cell since they might be corrupted:
/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc
RuleException:
CalledProcessError in file "/cluster/work/bewi/members/gbotta/exploratory_da/workflow/Snakefile", line 307:
Command ' singularity  exec --home '/cluster/work/bewi/members/gbotta/exploratory_da/workflow' -B /cluster/work/bewi/members/jgawron -B /scratch -B /cluster/work/bewi/members/gbotta:/cluster/work/bewi/members/gbotta:rw --bind '/cluster/home/gbotta/.cache/snakemake/snakemake/source-cache' /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg bash -c 'source /opt/conda/bin/activate '\''/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_'\''; set -euo pipefail;  
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/QGF-211699_QGF-211702_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt'' returned non-zero exit status 1.
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 21
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc
    log: logs/qc/on_target/gc_bias/QGF-211699_QGF-211702_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/QGF-211699_QGF-211702_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
        
        (command exited with non-zero exit code)
USAGE: CollectGcBiasMetrics [options]

Documentation: http://broadinstitute.github.io/picard/command-line-overview.html#CollectGcBiasMetrics

Collect metrics regarding GC bias. This tool collects information about the relative proportions of guanine (G) and
cytosine (C) nucleotides in a sample.  Regions of high and low G + C content have been shown to interfere with
mapping/aligning, ultimately leading to fragmented genome assemblies and poor coverage in a phenomenon known as 'GC
bias'.  Detailed information on the effects of GC bias on the collection and analysis of sequencing data can be found at
DOI: 10.1371/journal.pone.0062856/.


The GC bias statistics are always output in a detailed long-form version, but a summary can also be produced. Both the
detailed metrics and the summary metrics are output as tables '.txt' files) and an accompanying chart that plots the
data ('.pdf' file). 

Detailed metrics
The table of detailed metrics includes GC percentages for each bin (GC), the percentage of WINDOWS corresponding to each
GC bin of the reference sequence, the numbers of reads that start within a particular %GC content bin (READ_STARTS), and
the mean base quality of the reads that correspond to a specific GC content distribution window (MEAN_BASE_QUALITY). 
NORMALIZED_COVERAGE is a relative measure of sequence coverage by the reads at a particular GC content.For each run, the
corresponding reference sequence is divided into bins or windows based on the percentage of G + C content ranging from 0
- 100%.  The percentages of G + C are determined from a defined length of sequence; the default value is set at 100
bases. The mean of the distribution will vary among organisms; human DNA has a mean GC content of 40%, suggesting a
slight preponderance of AT-rich regions.  


Summary metrics
The table of summary metrics captures run-specific bias information including WINDOW_SIZE, ALIGNED_READS,
TOTAL_CLUSTERS, AT_DROPOUT, and GC_DROPOUT.  While WINDOW_SIZE refers to the numbers of bases used for the distribution
(see above), the ALIGNED_READS and TOTAL_CLUSTERS are the total number of aligned reads and the total number of reads
(after filtering) produced in a run. In addition, the tool produces both AT_DROPOUT and GC_DROPOUT metrics, which
indicate the percentage of misaligned reads that correlate with low (%-GC is < 50%) or high (%-GC is > 50%) GC content
respectively.  

The percentage of 'coverage' or depth in a GC bin is calculated by dividing the number of reads of a particular GC
content by the mean number of reads of all GC bins.  A number of 1 represents mean coverage, a number less than 1
represents lower than mean coverage (e.g. 0.5 means half as much coverage as average) while a number greater than 1
represents higher than mean coverage (e.g. 3.1 means this GC bin has 3.1 times more reads per window than average). 
This tool also tracks mean base-quality scores of the reads within each GC content bin, enabling the user to determine
how base quality scores vary with GC content.  

The chart output associated with this data table plots the NORMALIZED_COVERAGE, the distribution of WINDOWs
corresponding to GC percentages, and base qualities corresponding to each %GC bin.
Note: Metrics labeled as percentages are actually expressed as fractions!

Usage Example:

java -jar picard.jar CollectGcBiasMetrics \
I=input.bam \
O=gc_bias_metrics.txt \
CHART=gc_bias_metrics.pdf \
S=summary_metrics.txt \
R=reference_sequence.fasta
Please see the GcBiasMetrics documentation
(https://broadinstitute.github.io/picard/picard-metric-definitions.html#GcBiasMetrics) for further explanations of each
metric.

Version: 3.4.0


Options:

--help
-h                            Displays options specific to this tool.

--stdhelp
-H                            Displays options specific to this tool AND options common to all Picard command line
                              tools.

--version                     Displays program version.

CHART_OUTPUT=File
CHART=File                    The PDF file to render the chart to.  Required. 

SUMMARY_OUTPUT=File
S=File                        The text file to write summary metrics to.  Required. 

SCAN_WINDOW_SIZE=Integer
WINDOW_SIZE=Integer           The size of the scanning windows on the reference genome that are used to bin reads. 
                              Default value: 100. This option can be set to 'null' to clear the default value. 

MINIMUM_GENOME_FRACTION=Double
MGF=Double                    For summary metrics, exclude GC windows that include less than this fraction of the
                              genome.  Default value: 1.0E-5. This option can be set to 'null' to clear the default
                              value. 

IS_BISULFITE_SEQUENCED=Boolean
BS=Boolean                    Whether the SAM or BAM file consists of bisulfite sequenced reads.  Default value: false.
                              This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

METRIC_ACCUMULATION_LEVEL=MetricAccumulationLevel
LEVEL=MetricAccumulationLevel The level(s) at which to accumulate metrics.  Default value: [ALL_READS]. This option can
                              be set to 'null' to clear the default value. Possible values: {ALL_READS, SAMPLE, LIBRARY,
                              READ_GROUP} This option may be specified 0 or more times. This option can be set to 'null'
                              to clear the default list. 

ALSO_IGNORE_DUPLICATES=Boolean
ALSO_IGNORE_DUPLICATES=BooleanUse to get additional results without duplicates. This option allows to gain two plots per
                              level at the same time: one is the usual one and the other excludes duplicates.  Default
                              value: false. This option can be set to 'null' to clear the default value. Possible
                              values: {true, false} 

INPUT=File
I=File                        Input SAM/BAM/CRAM file.  Required. 

OUTPUT=File
O=File                        The file to write the output to.  Required. 

ASSUME_SORTED=Boolean
AS=Boolean                    If true (default), then the sort order in the header file will be ignored.  Default value:
                              true. This option can be set to 'null' to clear the default value. Possible values: {true,
                              false} 

STOP_AFTER=Long               Stop after processing N reads, mainly for debugging.  Default value: 0. This option can be
                              set to 'null' to clear the default value. 

RuleException:
CalledProcessError in file "/cluster/work/bewi/members/gbotta/exploratory_da/workflow/Snakefile", line 307:
Command ' singularity  exec --home '/cluster/work/bewi/members/gbotta/exploratory_da/workflow' -B /cluster/work/bewi/members/jgawron -B /scratch -B /cluster/work/bewi/members/gbotta:/cluster/work/bewi/members/gbotta:rw --bind '/cluster/home/gbotta/.cache/snakemake/snakemake/source-cache' /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg bash -c 'source /opt/conda/bin/activate '\''/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_'\''; set -euo pipefail;  
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/QGF-211698_QGF-211701_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt'' returned non-zero exit status 1.
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 18
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc
    log: logs/qc/off_target/gc_bias/QGF-211698_QGF-211701_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/QGF-211698_QGF-211701_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
        
        (command exited with non-zero exit code)
Removing output files of failed job get_binned_gc_bias_per_cell since they might be corrupted:
/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc
RuleException:
CalledProcessError in file "/cluster/work/bewi/members/gbotta/exploratory_da/workflow/Snakefile", line 307:
Command ' singularity  exec --home '/cluster/work/bewi/members/gbotta/exploratory_da/workflow' -B /cluster/work/bewi/members/jgawron -B /scratch -B /cluster/work/bewi/members/gbotta:/cluster/work/bewi/members/gbotta:rw --bind '/cluster/home/gbotta/.cache/snakemake/snakemake/source-cache' /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/singularity/2cb9c8d771e5e7fb3d89f3aeb2e90e44.simg bash -c 'source /opt/conda/bin/activate '\''/cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_'\''; set -euo pipefail;  
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/QGF-211698_QGF-211701_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt'' returned non-zero exit status 1.
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 13
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc
    log: logs/qc/on_target/gc_bias/QGF-211698_QGF-211701_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/QGF-211698_QGF-211701_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
        
        (command exited with non-zero exit code)
Removing output files of failed job get_binned_gc_bias_per_cell since they might be corrupted:
/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc
Removing output files of failed job get_binned_gc_bias_per_cell since they might be corrupted:
/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc
Shutting down, this might take some time.
Exiting because a job execution failed. Look below for error messages
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 18
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc
    log: logs/qc/off_target/gc_bias/QGF-211698_QGF-211701_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/QGF-211698_QGF-211701_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
        
        (command exited with non-zero exit code)
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 21
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc
    log: logs/qc/on_target/gc_bias/QGF-211699_QGF-211702_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/QGF-211699_QGF-211702_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
        
        (command exited with non-zero exit code)
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 2
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc
    log: logs/qc/on_target/gc_bias/PID2236_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/PID2236/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/PID2236_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
        
        (command exited with non-zero exit code)
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 26
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc
    log: logs/qc/off_target/gc_bias/QGF-211699_QGF-211702_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/QGF-211699_QGF-211702/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/QGF-211699_QGF-211702_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211699_QGF-211702/healthy_cells.txt
        
        (command exited with non-zero exit code)
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 10
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.off_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc
    log: logs/qc/off_target/gc_bias/PID2236_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/mapped.sorted.healthy_cells.off_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/off_target/gc_bias_sc/PID2236/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/off_target/gc_bias/PID2236_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/PID2236/healthy_cells.txt
        
        (command exited with non-zero exit code)
[Fri Oct 24 10:28:32 2025]
Error in rule get_binned_gc_bias_per_cell:
    message: None
    jobid: 13
    input: /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.on_target.bam, /cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa, /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
    output: /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc
    log: logs/qc/on_target/gc_bias/QGF-211698_QGF-211701_sc.log (check log file(s) for error details)
    conda-env: /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/conda/2f8db83afb96848c3c12c423e9a55a6e_
    shell:
        
        mkdir -p /cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc;
        while read CELL; do
            samtools view -b -h -d RG:$CELL /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/mapped.sorted.healthy_cells.on_target.bam |             picard CollectGcBiasMetrics I=/dev/stdin O=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.gc_bias_metrics.txt S=/cluster/work/bewi/members/gbotta/exploratory_da/results/qc/on_target/gc_bias_sc/QGF-211698_QGF-211701/picard_sc/$CELL.summary_metrics.txt R=/cluster/work/bewi/members/jgawron/INTeRCePT/tapestri/hg19/ucsc_hg19.fa >> logs/qc/on_target/gc_bias/QGF-211698_QGF-211701_sc.log
        done < /cluster/work/bewi/members/gbotta/exploratory_da/results/prepare/bams/QGF-211698_QGF-211701/healthy_cells.txt
        
        (command exited with non-zero exit code)
Complete log(s): /cluster/work/bewi/members/gbotta/exploratory_da/workflow/.snakemake/log/2025-10-24T102759.679092.snakemake.log
WorkflowError:
At least one job did not complete successfully.
